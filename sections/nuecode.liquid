


{{ 'component-accordion.css' | asset_url | stylesheet_tag }}
{{ 'nue-collapsible-content.css' | asset_url | stylesheet_tag }}
{{ 'nuecode.css' | asset_url | stylesheet_tag }}
{{ 'nutrition-modal.css' | asset_url | stylesheet_tag }}
{{ 'nuecode-modal.css' | asset_url | stylesheet_tag }}
<script src="{{ 'accordion-animation.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'product-modal.js' | asset_url }}" defer="defer"></script>

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top_mobile }}px;
    padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  {% for block in section.blocks %}
    {% if block.type == 'accordion_item' and block.settings.enable_modal and block.settings.modal_label_color != blank %}
      #NuecodeModalButton-{{ block.id }} {
        color: {{ block.settings.modal_label_color }};
      }
    {% endif %}
  {% endfor %}
{%- endstyle -%}

<div class="nuecode-wrapper section-{{ section.id }}-padding">
  <div class="page-width">
    <div class="nuecode-bg">
      {% if section.settings.bg_image != blank %}
        <img src="{{ section.settings.bg_image | image_url: width: 1320 }}" alt="Nue Code" class="nuecode-bg-image nuecode-bg-image--desktop" width="1320" height="1034">
      {% endif %}
      {% if section.settings.bg_image_mobile != blank %}
        <img src="{{ section.settings.bg_image_mobile | image_url: width: 750 }}" alt="Nue Code" class="nuecode-bg-image nuecode-bg-image--mobile" width="750" height="1034">
      {% endif %}
      {% if section.settings.logo_image != blank %}
        <div class="nuecode__header">
          <img src="{{ section.settings.logo_image | image_url: width: 465 }}" alt="Nue Code Logo" class="nuecode-logo" width="465" height="142">
        </div>
      {% endif %}

      <div class="nuecode__contnet">
        <div class="nuecode__contnet-wrap">
          <div class="nuecode__left">{{ section.settings.intro }}</div>
          <div class="nuecode__placeholder"></div>
          <div class="nuecode__right nue-collapsible-content">
            {% assign first_accordion = true %}
            {% for block in section.blocks %}
              {% if block.type == 'accordion_item' %}
                <div class="accordion" {{ block.shopify_attributes }}>
                  <details
                    id="Details-{{ block.id }}-{{ section.id }}"
                    {% if first_accordion %}
                      open
                    {% endif %}
                  >
                    <summary id="Summary-{{ block.id }}-{{ section.id }}">
                      <h3 class="accordion__title inline-richtext h4">
                        {{ block.settings.heading | escape }}
                      </h3>
                      {{- 'icon-caret.svg' | inline_asset_content -}}
                    </summary>
                    <div
                      class="accordion__content rte"
                      id="CollapsibleAccordion-{{ block.id }}-{{ section.id }}"
                      role="region"
                      aria-labelledby="Summary-{{ block.id }}-{{ section.id }}"
                    >
                      {{ block.settings.content }}

                      {%- if block.settings.enable_modal and block.settings.modal_label != blank -%}
                        {%- if block.settings.modal_image_desktop != blank or block.settings.modal_image_mobile != blank -%}
                          <modal-opener class="nutrition-modal__opener" data-modal="#NuecodeModal-{{ block.id }}">
                            <button id="NuecodeModalButton-{{ block.id }}" class="nutrition-modal__button link underlined-link" type="button" aria-haspopup="dialog">
                              {{ block.settings.modal_label }}
                            </button>
                          </modal-opener>
                        {%- endif -%}
                      {%- endif -%}
                    </div>
                  </details>
                </div>
                {% assign first_accordion = false %}
              {% endif %}
            {% endfor %}
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

{% comment %} Modal dialogs for each accordion item {% endcomment %}
{% for block in section.blocks %}
  {% if block.type == 'accordion_item' and block.settings.enable_modal %}
    {% if block.settings.modal_image_desktop != blank or block.settings.modal_image_mobile != blank %}
      <modal-dialog id="NuecodeModal-{{ block.id }}" class="nutrition-modal">
        <div
          role="dialog"
          aria-label="{{ block.settings.modal_alt_text | default: block.settings.heading }}"
          aria-modal="true"
          class="nutrition-modal__content"
          tabindex="-1"
        >
          <button
            id="ModalClose-NuecodeModal-{{ block.id }}"
            type="button"
            class="nutrition-modal__close"
            aria-label="{{ 'accessibility.close' | t }}"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 19 19" fill="none">
              <path d="M1 1L9.5 9.5M18 18L9.5 9.5M9.5 9.5L18 1L1 18" stroke="currentColor"/>
            </svg>
          </button>
          <div class="nutrition-modal__images">
            {%- if block.settings.modal_image_desktop != blank -%}
              <img
                class="nutrition-modal__image nutrition-modal__image--desktop"
                src="{{ block.settings.modal_image_desktop | image_url: width: 1000 }}"
                loading="lazy"
                alt="{{ block.settings.modal_alt_text | default: block.settings.heading }}"
              >
            {%- endif -%}
            {%- if block.settings.modal_image_mobile != blank -%}
              <img
                class="nutrition-modal__image nutrition-modal__image--mobile"
                src="{{ block.settings.modal_image_mobile | image_url: width: 700 }}"
                loading="lazy"
                alt="{{ block.settings.modal_alt_text | default: block.settings.heading }}"
              >
            {%- elsif block.settings.modal_image_desktop != blank -%}
              <img
                class="nutrition-modal__image nutrition-modal__image--mobile"
                src="{{ block.settings.modal_image_desktop | image_url: width: 700 }}"
                loading="lazy"
                alt="{{ block.settings.modal_alt_text | default: block.settings.heading }}"
              >
            {%- endif -%}
          </div>
        </div>
      </modal-dialog>
    {% endif %}
  {% endif %}
{% endfor %}

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Prevent default behavior for any links inside modal buttons
    document.querySelectorAll('.nutrition-modal__opener a').forEach(function(link) {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        // Allow propagation so the modal can still open
      });
    });
  });
</script>

{% schema %}
  {
    "name": "Nue Code",
    "tag": "section",
    "settings": [
      {
        "type": "image_picker",
        "id": "bg_image",
        "label": "Background Image (Desktop)"
      },
      {
        "type": "image_picker",
        "id": "bg_image_mobile",
        "label": "Background Image (Mobile)",
        "info": "Optional mobile background image. If not set, desktop image will be used."
      },
      {
        "type": "image_picker",
        "id": "logo_image",
        "label": "Logo Image (replaces SVG)"
      },
      {
        "type": "text",
        "id": "intro",
        "label": "Intro text",
        "default": "The Nue Co.de is our method for creating the cleanest and safest supplements â€“ prioritizing ingredient quality and testing while honoring our sustainability and ethical sourcing values."
      },
      {
        "type": "header",
        "content": "t:sections.all.padding.section_padding_heading"
      },
      {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 142,
        "step": 2,
        "unit": "px",
        "label": "Desktop padding top",
        "default": 36
      },
      {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 142,
        "step": 2,
        "unit": "px",
        "label": "Desktop padding bottom",
        "default": 36
      },
      {
        "type": "range",
        "id": "padding_top_mobile",
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Mobile padding top",
        "default": 40
      },
      {
        "type": "range",
        "id": "padding_bottom_mobile",
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Mobile padding bottom",
        "default": 40
      }
    ],
  "blocks": [
    {
      "type": "accordion_item",
      "name": "Accordion Item",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Accordion Title"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Content",
          "default": "<p>Accordion content goes here.</p>"
        },
        {
          "type": "header",
          "content": "Modal Settings"
        },
        {
          "type": "checkbox",
          "id": "enable_modal",
          "label": "Enable Modal",
          "default": false
        },
        {
          "type": "text",
          "id": "modal_label",
          "label": "Modal Label",
          "default": "SEE FULL DETAILS",
          "info": "Text for the clickable link that opens the modal"
        },
        {
          "type": "color",
          "id": "modal_label_color",
          "label": "Modal Label Color",
          "info": "Leave blank to use default color"
        },
        {
          "type": "image_picker",
          "id": "modal_image_desktop",
          "label": "Modal Image (Desktop)",
          "info": "Image to display in the modal on desktop screens"
        },
        {
          "type": "image_picker",
          "id": "modal_image_mobile",
          "label": "Modal Image (Mobile)",
          "info": "Optional mobile image. If not set, desktop image will be used."
        },
        {
          "type": "text",
          "id": "modal_alt_text",
          "label": "Modal Image Alt Text",
          "info": "Alternative text for accessibility. If blank, heading will be used."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Nue Code",
      "blocks": [
        {
          "type": "accordion_item",
          "settings": {
            "heading": "Research",
            "content": "<p>We bridge the gap between inner and outer health by hosting expert roundtables, investing in research, and involving multidisciplinary teams including pharmacologists, dermatologists, nutritionists, led by our Chief Science Officer, Professor Bill Charman.</p>"
          }
        },
        {
          "type": "accordion_item",
          "settings": {
            "heading": "Ingredients",
            "content": "<p>We bridge the gap between inner and outer health by hosting expert roundtables, investing in research, and involving multidisciplinary teams including pharmacologists, dermatologists, nutritionists, led by our Chief Science Officer, Professor Bill Charman.</p>"
          }
        },
        {
          "type": "accordion_item",
          "settings": {
            "heading": "Testing",
            "content": "<p>We bridge the gap between inner and outer health by hosting expert roundtables, investing in research, and involving multidisciplinary teams including pharmacologists, dermatologists, nutritionists, led by our Chief Science Officer, Professor Bill Charman.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}
